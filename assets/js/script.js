// EASY QUESTIONS
let easyQuestions = [
    {   
        id: 1,
        question: "What is the capital of France?",
        correctAnswer: "Paris",
        wrongAnswers: ["Italy", "Cannes", "Marseille"]
	},
    {   
        id: 2,
        question: "Which Queen of Pop was married to Guy Ritchie and Sean Penn?",
        correctAnswer: "Madonna",
        wrongAnswers: ["Celine Dion", "Mariah Carey", "Cher"]
	},
    {   
        id: 3,
        question: "What brand is also known as the Golden Arches?",
        correctAnswer: "McDonalds",
        wrongAnswers: ["KFC", "Kenny Rogers", "Subway"]
	},
    {   
        id: 4,
        question: "Often described as the longest river on earth, on which continent would you find the Nile?",
        correctAnswer: "Africa",
        wrongAnswers: ["Asia", "Europe", "North America"]
	},
    {   
        id: 5,
        question: "What elements make up water?",
        correctAnswer: "oxygen and hydrogen",
        wrongAnswers: ["oxygen and nitrogen", "oxygen and carbon", "oxygen and sodium"]
	},
    {   
        id: 6,
        question: "Which scientist came up with the theory of E=MC2?",
        correctAnswer: "Albert Einstein",
        wrongAnswers: ["Isaac Newton", "Marie Curie", "Stephen Hawking"]
	},
    {   
        id: 7,
        question: "What animal is Pumbaa in the Lion King?",
        correctAnswer: "warthog",
        wrongAnswers: ["tiger", "meerkat", "mandrill"]
	},
    {
        id: 8,
        question: "How many cards are there in a pack of cards (excluding jokers)?",
        correctAnswer: "52",
        wrongAnswers: ["32", "60", "50"]
	},
    {
        id: 9,
        question: "What bird is famous for being pink?",
        correctAnswer: "Flamingo",
        wrongAnswers: ["turaco", "southern cassowary", "bar-throated minla"]
	},
    {   
        id: 10,
        question: "What planet is closest to the sun? ",
        correctAnswer: "Mercury",
        wrongAnswers: ["Saturn", "Venus", "Pluto"]
	},
]

// MODERATE QUESTIONS
let moderateQuestions = [
    {
        id: 11,
        question: "Which British King famously had six wives?",
        correctAnswer: "Henry VIII",
        wrongAnswers: ["George VI", "George V", "William IV"]
	},
    {
        id: 12,
        question: "Conquering much of China and central Asia, uniting the wandering tribes and even responsible for creating one of the first international postal systems, who led the Mongols?",
        correctAnswer: "Genghis Khan",
        wrongAnswers: ["Kublai Khan", "The Bogd Khan", "Kaidu" ]
	},
    {
        id: 13,
        question: "Which German classical composer and pianist, was the film Immortal Beloved about?",
        correctAnswer: "Ludwig van Beethoven",
        wrongAnswers: ["Mozart", "Johannes Brahms", "Felix Mendelssohn"]
	},
    {
        id: 14,
        question: "In which country would you find Angel Falls, the highest waterfall on earth?",
        correctAnswer: "Venezuela",
        wrongAnswers: ["Mexico", "Canada", "Brazil"]
	},
    {
        id: 15,
        question: "The gaseous elements helium, neon, argon, krypton, xenon, and radon are better known as what?",
        correctAnswer: "noble gases",
        wrongAnswers: ["halogens", "simple gases", "liquified gases"]
	},
    {
        id: 16,
        question: "What is the name of Saturnâ€™s largest moon?",
        correctAnswer: "Titan",
        wrongAnswers: ["Enceladus", "Mimas", "Rhea"]
	},
    {
        id: 17,
        question: "What character has both Robert Downey Jr. and Benedict Cumberbatch played?",
        correctAnswer: "Sherlock Holmes",
        wrongAnswers: ["'Mad' Max Rockatansky", "Charles Spencer Chaplin", "Alan Turing"]
	},
    {
        id: 18,
        question: "What country drinks the most coffee per person?",
        correctAnswer: "Finland",
        wrongAnswers: ["USA", "Canada", "Denmark"]
	},
    {
        id: 19,
        question: "What company was initially known as 'Blue Ribbon Sports'?",
        correctAnswer: "Nike",
        wrongAnswers: ["Addidas", "Puma", "Reebok"]
	},
    {
        id: 20,
        question: "What are the colours of the Olympic Rings?",
        correctAnswer: "red, green, black, blue and yellow",
        wrongAnswers: ["green, yellow, violet, blue, white", "yellow, red, brown, blue, green", "black, orange, yellow, green, red"]
	},
]

// HARD QUESTIONS
let hardQuestions = [
    {
        id: 21,
        question: "Aureolin is a shade of what colour?",
        correctAnswer: "yellow",
        wrongAnswers: ["pink", "orange", "blue"]
	},
    {
        id: 22,
        question: "In what country is the Chernobyl nuclear plant located?",
        correctAnswer: "Ukraine",
        wrongAnswers: ["Austria", "Norway", "Poland"]
	},
    {
        id: 23,
        question: "How many dots appear on a pair of dice?",
        correctAnswer: "42",
        wrongAnswers: ["21", "52", "32"]
	},
    {
        id: 24,
        question: "What country has the only national flag that does not have four sides?",
        correctAnswer: "Nepal",
        wrongAnswers: ["Luxembourg", "Taiwan", "Tuvalu"]
	},
    {
        id: 25,
        question: "What sporting event has a strict dress code of almost entirely white?",
        correctAnswer: "Wimbledon",
        wrongAnswers: ["Tour de France", "Royal Ascot", "US Masters Tournament"]
	},
    {
        id: 26,
        question: "How many minutes are in a full week?",
        correctAnswer: "10,080 minutes",
        wrongAnswers: ["20,160 minutes", "43,800 minutes", "7,200 minutes"]
	},
    {
        id: 27,
        question: "In what capital would you find The Little Mermaid statue?",
        correctAnswer: "Copenhagen",
        wrongAnswers: ["Vienna", "Helsinki", "Athens"]
	},
    {
        id: 28,
        question: "What is Cynophobia the fear of?",
        correctAnswer: "dogs",
        wrongAnswers: ["cats", "computers", "accidents"]
	},
    {
        id: 29,
        question: "Unix Time is defined as the number of seconds that have elapsed since when?",
        correctAnswer: "midnight of January 1, 1970",
        wrongAnswers: ["midnight of January 1, 1987", "noontime of January 1, 1970", "noontime of January 1, 1987"]
	},
    {
        id: 30,
        question: "Who first coined the term 'battery' to describe an electrical storage device?",
        correctAnswer: "Benjamin Franklin",
        wrongAnswers: ["Henry Ford", "Michael Faraday", "Albert Einstein"]
	},
]

// MILLION EURO QUESTIONS
let hardestQuestions = [
    {
        id: 31,
        question: "What is a group of pandas known as?",
        correctAnswer: "an embarassment",
        wrongAnswers: ["a shrewdness", "a murder", "a convocation"]
	},
    {
        id: 32,
        question: "How long is an elephant pregnant before it gives birth?",
        correctAnswer: "22 months",
        wrongAnswers: ["9 months", "12 months", "16 months"]
	},
    {
        id: 33,
        question: "The first successful vaccine was introduced by Edward Jenner in 1796. Which disease did it guard against?",
        correctAnswer: "Smallpox",
        wrongAnswers: ["Yellow Fever", "Poliomyelitis", "Tuberculosis"]
	},
    {
        id: 34,
        question: "Who is the only musician ever to have been awarded the Nobel prize for literature?",
        correctAnswer: "Bob Dylan",
        wrongAnswers: ["Jimi Hendrix", "Elton John", "Stevie Wonder"]
	},
]

document.addEventListener('DOMContentLoaded', function(event) {
    // local variables for text contents of each question
    let questionText = document.getElementById('question-text');
    let optionOneText = document.getElementById('option1-text');
    let optionTwoText = document.getElementById('option2-text');
    let optionThreeText = document.getElementById('option3-text');
    let optionFourText = document.getElementById('option4-text');

    let questionNumber = document.getElementById('question-number');
    let answerButtons = document.getElementsByClassName('answer-button');

    // list container for the IDs of used questions
    let usedQuestions = [];

    // selects and displays first question
    let selectedQuestion = questionRandomizer(easyQuestions);
    displayQuestion(selectedQuestion, questionNumber, questionText, optionOneText, optionTwoText, optionThreeText, optionFourText);

    // timer
    let timerValue = document.getElementById('timer-value');
    let counter = timer(timerValue);

    // lifelines event listeners
    let lifeLines = document.getElementsByClassName('life-line-item');
    for (lifeItem of lifeLines) {
        lifeItem.addEventListener('click', function() {
            if (this.getAttribute('data-lifeline') === 'remove-one-option') {
                randomChoiceRemove(selectedQuestion, 1, answerButtons);
                // deactives the lifeline button after using. This code is from stackoverflow: https://stackoverflow.com/questions/4950115/removeeventlistener-on-anonymous-functions-in-javascript
                this.removeEventListener('click', arguments.callee);
            } else if (this.getAttribute('data-lifeline') === 'remove-two-options') {
                randomChoiceRemove(selectedQuestion, 2, answerButtons);
                // deactives the lifeline button after using. This code is from stackoverflow: https://stackoverflow.com/questions/4950115/removeeventlistener-on-anonymous-functions-in-javascript
                this.removeEventListener('click', arguments.callee);
            } else {
                console.log('add more time')
            }
    })
    }

    // buttons for answer choices
    for (answerBtn of answerButtons) {
        answerBtn.addEventListener('click', function() {
            clearInterval(counter.id);
            if (answerChecker(selectedQuestion, this.innerText.slice(3))) {
                undisableOptionBtns(answerButtons)
                usedQuestions.push(selectedQuestion.id);
                counter = timer(timerValue);
                if (usedQuestions.length < 15) {
                    alert("Continue game");
                    if (usedQuestions.length <= 4){
                        selectedQuestion = questionRandomizer(easyQuestions);
                        while (usedQuestions.includes(selectedQuestion.id)) {
                            selectedQuestion = questionRandomizer(easyQuestions);
                        }
                    } else if (usedQuestions.length > 4 && usedQuestions.length < 10) {
                        selectedQuestion = questionRandomizer(moderateQuestions);
                        while (usedQuestions.includes(selectedQuestion.id)) {
                            selectedQuestion = questionRandomizer(moderateQuestions);
                        }
                    } else if (usedQuestions.length >= 10 && usedQuestions.length < 14) {
                        selectedQuestion = questionRandomizer(hardQuestions);
                        while (usedQuestions.includes(selectedQuestion.id)) {
                            selectedQuestion = questionRandomizer(hardQuestions);
                        }
                    } else {
                        selectedQuestion = questionRandomizer(hardestQuestions);
                    }
                    displayQuestion(selectedQuestion, questionNumber, questionText, optionOneText, optionTwoText, optionThreeText, optionFourText);
                } else {
                    alert('YOU WON!')
                }
            } else {
                gameOver();
            }
            console.log(usedQuestions)
        })
    }
});

/**
 * Returns randomized question from a category as specified
 * in the argument passed
 */
function questionRandomizer(questionCategory) {
    let randomNumber = Math.floor(Math.random() * questionCategory.length);
    return questionCategory[randomNumber];
}

/**
 * Displays the question and options in the game page
 * @param {Object} qselected - The question object as returned by the question randomizer
 * @param {*} qtext - The html element for the question text
 * @param {*} opt1 - The html element for the first answer choice
 * @param {*} opt2 - The html element for the second answer choice
 * @param {*} opt3 - The html element for the third answer choice
 * @param {*} opt4 - The html element for the forth answer choice
 */
function displayQuestion(qselected, qnumber, qtext, opt1, opt2, opt3, opt4) {
    // displays the question in the game page
    qtext.innerText = qselected.question;

    // Increment question number as game progresses
    qnumber.innerText++;
    
    // displays the answer options in the game page randomly
    let shuffledOptions = shuffleOptions(qselected)
    opt1.innerText = shuffledOptions[0];
    opt2.innerText = shuffledOptions[1];
    opt3.innerText = shuffledOptions[2];
    opt4.innerText = shuffledOptions[3];
}

/**
 * Returns a shuffled list of answer options from the random question 
 * passed in the parameter
 */
function shuffleOptions(questionObj) {
    let optionsList = [questionObj.correctAnswer, questionObj.wrongAnswers[0], questionObj.wrongAnswers[1], questionObj.wrongAnswers[2]];
    for (let i = 0; i < 4; i++) {
        let randIndex = Math.floor(Math.random() * optionsList.length)
        lastItem = optionsList.pop();
        optionsList.splice(randIndex, 0, lastItem)
    };
    return optionsList;
}

/**
 * Checks the user's answer and returns true if correct, and false if not
 * @param {*} questionObj - randomized question object 
 * @param {*} answerText - text content of the answer
 * @returns true or false
 */
function answerChecker(questionObj, answerText) {
    if (questionObj.correctAnswer === answerText) {
        console.log("Correct!", questionObj.correctAnswer, "=", answerText);
        return true
    } else {
        console.log(`Wrong! 
        Correct Answer: ${questionObj.correctAnswer}, 
        "Your answer:", ${answerText}`);
        return false
    }
}

/**
 * Displays a timer
 * @param {*} counter 
 * @returns an object with setInterval id, and time left
 */
function timer(counter) {
    let timeLeft = 30;
    let timeInterval = setInterval(function(){
        if (timeLeft >= 0) {
            timeLeft--;
            counter.innerText = timeLeft + 1;
        } else {
            gameOver();
            clearInterval(timeInterval);
        }
    }, 1000);
    return {id: timeInterval, timeLeft: timeLeft};
}

function gameOver() {
    alert(`Sorry, game Over!`)
    location.reload();
}

function randomChoiceRemove(question, num, optionButtons) {
    randNum = Math.floor(Math.random() * 3)
    let options = []
    for (let i = 0; i < num; i++) {
        randNum = Math.floor(Math.random() * 3);
        selectedAnswer = question.wrongAnswers[randNum]
        while (options.includes(selectedAnswer)) {
            randNum = Math.floor(Math.random() * 3);
            selectedAnswer = question.wrongAnswers[randNum]
        }
        options.push(question.wrongAnswers[randNum]);
    }
    for (optionBtn of optionButtons) {
        for (let i = 0; i < options.length; i++) {
            if (optionBtn.innerText.slice(3) === options[i]) {
                optionBtn.disabled = true;
            }
        }
    }
}

function undisableOptionBtns(optionButtons) {
    for (optionBtn of optionButtons) {
        optionBtn.disabled = false;
    }
}